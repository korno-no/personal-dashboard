<div class="container-center">
  <div class="new-task">
    <textarea type="text"
      class="input input_new-task"
      type="textarea"
      name="new-task"
      [(ngModel)]="newTask" 
    ></textarea>
    <app-button 
      [label]="'new task'" 
      [disabled]="!newTask().trim()"
      [theme]="'new-task'" 
      (clicked)="onAddNewTask()" >
    </app-button>
  </div>
  <div class="buttons filters-group">
    <app-tab-slider 
      [tabs] = "['all', 'active', 'done']"
      (selectedTab) = "selectedTab.set($event)"
    ></app-tab-slider>
    <app-dropdown 
      [label]="'Sort by'"
      [values]="['default', 'date', 'text']"
      [selected]="sortBy()"
      (newSelected)="onSortChange($event)"
    ></app-dropdown>
  </div>

  <div class="task-list"> 
    <div class="scroll-conatiner">
      @for(task of processedTaskList(); track task.id){
        <div class="task-item" [class]="{'task-item_done': task.isDone()}">
          @if(task.editing()){
            <textarea type="text"
              class="input input_edit-task"
              type="textarea"
              name="edit-task"
              [(ngModel)]="task.editText" 
            ></textarea>
            <div class="buttons">
              <app-button 
                [label]="'save'" 
                [disabled]="!task.editText().trim() "
                [theme]="'button_save'" 
                (clicked)="onSaveEditTask(task.id)" >
              </app-button>
              <app-button 
                [label]="'cancel'" 
                [theme]="'button_cancel'" 
                (clicked)="onCancelEditTask(task.id)" >
              </app-button>
            </div>
          }
          @else{
            <label class="checkbox">
              <input
                type="checkbox"
                name="is-done"
                [(ngModel)]="task.isDone" 
                (change)="onSaveEditTask(task.id)"
                />
              <span></span>
            </label>
            {{task.text()}}
            <div class="buttons">
              <app-button 
                [label]="'delete'" 
                [theme]="'button_delete'" 
                (click)="onDeleteTask(task.id)"
                [disabled]="task.isDone()" >
              </app-button>
              <app-button 
                [label]="'edit'" 
                [theme]="'button_edit'" 
                (clicked)="onStartEditTask(task.id)" 
                [disabled]="task.isDone()">
              </app-button>
            </div>
          }
        </div>
      }
      @empty(){
        <p>You don't have tasks yet</p>
      }
    </div>    
  </div>
</div>